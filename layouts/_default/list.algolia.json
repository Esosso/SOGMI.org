[
    {{ range .Site.RegularPages }}
    {{ if ne .Params.DisableSearch true }}
        {{ $title := .Title }}{{ $description := .Description }}{{ $summary := .Summary }}
        {{ $pdate := .PublishDate }}{{ $rperm := .RelPermalink }}{{ $section := .Section }}
        {{ $date := .Date.UTC.Unix }}

        {{ $thumbnail := .Params.Thumbnail }}{{ $image := .Params.FeaturedImage }}
        {{ $ytimage := .Params.YoutubeID }}{{ $profilephoto := .Params.profilePhoto }}

        {{ $keywords := .Params.Keywords }}{{ $series := .Params.Series }}{{ $tags := .Params.Tags }}
        {{ $authors := .Params.Authors }}{{ $hosts := .Params.Hosts }}{{ $vkeywords := .Params.VideoKeywords }}
        
        {{ $id := .UniqueID }}

        {{ if eq .Section "podcasts" }}
            {{ range $index, $split := split .Content "<split>"}}
                {
                    "title": {{ jsonify $title }},
                    "date": {{ $date }},
                    {{ if $description }}"description": {{ jsonify $description }},{{ end }}
                    {{ if eq $index 0 }}"objectID": "{{ $id }}",{{ else }}"objectID": "{{ $id }}{{ $index }}",{{ end }}
                    {{ if $thumbnail }}"featuredImage": "{{ $thumbnail }}",{{ else }}{{ if $image }}"featuredImage": "{{ $image }}",{{ end }}{{ end }}
                    {{ if $hosts }}"hosts": {{ jsonify $hosts }},{{ end }}
                    {{ if $keywords }}"keywords": {{ jsonify $keywords }},{{ end }}
                    {{ if $tags }}"tags": {{ jsonify $tags }},{{ end }}
                    {{ if $authors }}"authors": {{ jsonify $authors }},{{ end }}
                    {{ if $vkeywords }}"videokeywords": {{ jsonify $vkeywords}},{{ end }}
                    "publishdate": "{{ $pdate }}",
                    "section": "{{ $section }}",
                    {{ if $series }}"series": "{{ $series }}",{{ end }}
                    {{ if eq $section "podcasts"}} "content": {{ jsonify . }},{{ end }}
                    "relpermalink": "{{ $rperm }}"
                },
            {{ end }}
        {{ else }}
            {
                "title": {{ jsonify $title }},
                "date": {{ $date }},
                {{ if $description }}"description": {{ jsonify $description }},{{ end }}
                "objectID": "{{ $id }}",
                {{ if $thumbnail }}"featuredImage": "{{ $thumbnail }}",{{ else }}
                    {{ if $image }}"featuredImage": "{{ $image }}",{{ else }}
                        {{ if $ytimage }}"featuredImage": "https://i.ytimg.com/vi/{{ $ytimage }}/hqdefault.jpg",{{ else }}
                            {{ if $profilephoto }}"featuredImage": "{{ $profilephoto }}",{{ end }}
                        {{ end }}
                    {{ end }}
                {{ end }}
                {{ if $hosts }}"hosts": {{ jsonify $hosts }},{{ end }}
                {{ if $keywords }}"keywords": {{ jsonify $keywords }},{{ end }}
                {{ if $tags }}"tags": {{ jsonify $tags }},{{ end }}
                {{ if $authors }}"authors": {{ jsonify $authors }},{{ end }}
                {{ if $vkeywords }}"videokeywords": {{ jsonify $vkeywords}},{{ end }}
                "publishdate": "{{ $pdate }}",
                "relpermalink": "{{ $rperm }}",
                "section": "{{ $section }}",
                {{ if $series }}"series": "{{ $series }}",{{ end }}
                "summary": {{ jsonify $summary }}
            },
        {{ end }}
    {{ end }}
{{ end }}
{{ range last 1 .Site.RegularPages }}
    {{ if ne .Params.DisableSearch true }}
        {{ $title := .Title }}{{ $description := .Description }}{{ $summary := .Summary }}
        {{ $pdate := .PublishDate }}{{ $rperm := .RelPermalink }}{{ $section := .Section }}
        {{ $date := .Date.UTC.Unix }}

        {{ $thumbnail := .Params.Thumbnail }}{{ $image := .Params.FeaturedImage }}
        {{ $ytimage := .Params.YoutubeID }}{{ $profilephoto := .Params.profilePhoto }}

        {{ $keywords := .Params.Keywords }}{{ $series := .Params.Series }}{{ $tags := .Params.Tags }}
        {{ $authors := .Params.Authors }}{{ $hosts := .Params.Hosts }}{{ $vkeywords := .Params.VideoKeywords }}
        
        {{ $id := .UniqueID }}

            {
                "title": {{ jsonify $title }},
                "date": {{ $date }},
                {{ if $description }}"description": {{ jsonify $description }},{{ end }}
                "objectID": "{{ $id }}",
                {{ if $thumbnail }}"featuredImage": "{{ $thumbnail }}",{{ else }}
                    {{ if $image }}"featuredImage": "{{ $image }}",{{ else }}
                        {{ if $ytimage }}"featuredImage": "https://i.ytimg.com/vi/{{ $ytimage }}/hqdefault.jpg",{{ else }}
                            {{ if $profilephoto }}"featuredImage": "{{ $profilephoto }}",{{ end }}
                        {{ end }}
                    {{ end }}
                {{ end }}
                {{ if $hosts }}"hosts": {{ jsonify $hosts }},{{ end }}
                {{ if $keywords }}"keywords": {{ jsonify $keywords }},{{ end }}
                {{ if $tags }}"tags": {{ jsonify $tags }},{{ end }}
                {{ if $authors }}"authors": {{ jsonify $authors }},{{ end }}
                {{ if $vkeywords }}"videokeywords": {{ jsonify $vkeywords}},{{ end }}
                "publishdate": "{{ $pdate }}",
                "relpermalink": "{{ $rperm }}",
                "section": "{{ $section }}",
                {{ if $series }}"series": "{{ $series }}",{{ end }}
                "summary": {{ jsonify $summary }}
            }

    {{ end }}
{{ end }}
]